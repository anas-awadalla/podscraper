from bs4 import BeautifulSoup
import csv
import requests
import logging


class CategoryScraper(object):
    """Initialize a new instance of CategoryScraper"""

    def __init__(self, path):
        self.path = path.joinpath("categories")
        self.session = requests.Session()
        adapter = requests.adapters.HTTPAdapter(max_retries=10)
        self.session.mount('https://', adapter)

    def scrape(self):
        """Scrap the category page URLs to get a listing of iTunes web addresses"""
        TIMEOUT = 10.0
        ITUNES_BASE_URL = "https://itunes.apple.com/us/genre/"

        CATEGORIES = {
            'artsA': 'podcasts-arts/id1301?letter=A',
             'artsB': 'podcasts-arts/id1301?letter=B',
             'artsC': 'podcasts-arts/id1301?letter=C',
             'artsD': 'podcasts-arts/id1301?letter=D',
             'artsE': 'podcasts-arts/id1301?letter=E',
             'artsF': 'podcasts-arts/id1301?letter=F',
             'artsG': 'podcasts-arts/id1301?letter=G',
             'artsH': 'podcasts-arts/id1301?letter=H',
             'artsI': 'podcasts-arts/id1301?letter=I',
             'artsJ': 'podcasts-arts/id1301?letter=J',
             'artsK': 'podcasts-arts/id1301?letter=K',
             'artsL': 'podcasts-arts/id1301?letter=L',
             'artsM': 'podcasts-arts/id1301?letter=M',
             'artsN': 'podcasts-arts/id1301?letter=N',
             'artsO': 'podcasts-arts/id1301?letter=O',
             'artsP': 'podcasts-arts/id1301?letter=P',
             'artsQ': 'podcasts-arts/id1301?letter=Q',
             'artsR': 'podcasts-arts/id1301?letter=R',
             'artsS': 'podcasts-arts/id1301?letter=S',
             'artsT': 'podcasts-arts/id1301?letter=T',
             'artsU': 'podcasts-arts/id1301?letter=U',
             'artsV': 'podcasts-arts/id1301?letter=V',
             'artsW': 'podcasts-arts/id1301?letter=W',
             'artsX': 'podcasts-arts/id1301?letter=X',
             'artsY': 'podcasts-arts/id1301?letter=Y',
             'artsZ': 'podcasts-arts/id1301?letter=Z',
             'businessA': 'podcasts-business/id1321?letter=A',
             'businessB': 'podcasts-business/id1321?letter=B',
             'businessC': 'podcasts-business/id1321?letter=C',
             'businessD': 'podcasts-business/id1321?letter=D',
             'businessE': 'podcasts-business/id1321?letter=E',
             'businessF': 'podcasts-business/id1321?letter=F',
             'businessG': 'podcasts-business/id1321?letter=G',
             'businessH': 'podcasts-business/id1321?letter=H',
             'businessI': 'podcasts-business/id1321?letter=I',
             'businessJ': 'podcasts-business/id1321?letter=J',
             'businessK': 'podcasts-business/id1321?letter=K',
             'businessL': 'podcasts-business/id1321?letter=L',
             'businessM': 'podcasts-business/id1321?letter=M',
             'businessN': 'podcasts-business/id1321?letter=N',
             'businessO': 'podcasts-business/id1321?letter=O',
             'businessP': 'podcasts-business/id1321?letter=P',
             'businessQ': 'podcasts-business/id1321?letter=Q',
             'businessR': 'podcasts-business/id1321?letter=R',
             'businessS': 'podcasts-business/id1321?letter=S',
             'businessT': 'podcasts-business/id1321?letter=T',
             'businessU': 'podcasts-business/id1321?letter=U',
             'businessV': 'podcasts-business/id1321?letter=V',
             'businessW': 'podcasts-business/id1321?letter=W',
             'businessX': 'podcasts-business/id1321?letter=X',
             'businessY': 'podcasts-business/id1321?letter=Y',
             'businessZ': 'podcasts-business/id1321?letter=Z',
             'comedyA': 'podcasts-comedy/id1303?letter=A',
             'comedyB': 'podcasts-comedy/id1303?letter=B',
             'comedyC': 'podcasts-comedy/id1303?letter=C',
             'comedyD': 'podcasts-comedy/id1303?letter=D',
             'comedyE': 'podcasts-comedy/id1303?letter=E',
             'comedyF': 'podcasts-comedy/id1303?letter=F',
             'comedyG': 'podcasts-comedy/id1303?letter=G',
             'comedyH': 'podcasts-comedy/id1303?letter=H',
             'comedyI': 'podcasts-comedy/id1303?letter=I',
             'comedyJ': 'podcasts-comedy/id1303?letter=J',
             'comedyK': 'podcasts-comedy/id1303?letter=K',
             'comedyL': 'podcasts-comedy/id1303?letter=L',
             'comedyM': 'podcasts-comedy/id1303?letter=M',
             'comedyN': 'podcasts-comedy/id1303?letter=N',
             'comedyO': 'podcasts-comedy/id1303?letter=O',
             'comedyP': 'podcasts-comedy/id1303?letter=P',
             'comedyQ': 'podcasts-comedy/id1303?letter=Q',
             'comedyR': 'podcasts-comedy/id1303?letter=R',
             'comedyS': 'podcasts-comedy/id1303?letter=S',
             'comedyT': 'podcasts-comedy/id1303?letter=T',
             'comedyU': 'podcasts-comedy/id1303?letter=U',
             'comedyV': 'podcasts-comedy/id1303?letter=V',
             'comedyW': 'podcasts-comedy/id1303?letter=W',
             'comedyX': 'podcasts-comedy/id1303?letter=X',
             'comedyY': 'podcasts-comedy/id1303?letter=Y',
             'comedyZ': 'podcasts-comedy/id1303?letter=Z',
             'educationA': 'podcasts-education/id1304?letter=A',
             'educationB': 'podcasts-education/id1304?letter=B',
             'educationC': 'podcasts-education/id1304?letter=C',
             'educationD': 'podcasts-education/id1304?letter=D',
             'educationE': 'podcasts-education/id1304?letter=E',
             'educationF': 'podcasts-education/id1304?letter=F',
             'educationG': 'podcasts-education/id1304?letter=G',
             'educationH': 'podcasts-education/id1304?letter=H',
             'educationI': 'podcasts-education/id1304?letter=I',
             'educationJ': 'podcasts-education/id1304?letter=J',
             'educationK': 'podcasts-education/id1304?letter=K',
             'educationL': 'podcasts-education/id1304?letter=L',
             'educationM': 'podcasts-education/id1304?letter=M',
             'educationN': 'podcasts-education/id1304?letter=N',
             'educationO': 'podcasts-education/id1304?letter=O',
             'educationP': 'podcasts-education/id1304?letter=P',
             'educationQ': 'podcasts-education/id1304?letter=Q',
             'educationR': 'podcasts-education/id1304?letter=R',
             'educationS': 'podcasts-education/id1304?letter=S',
             'educationT': 'podcasts-education/id1304?letter=T',
             'educationU': 'podcasts-education/id1304?letter=U',
             'educationV': 'podcasts-education/id1304?letter=V',
             'educationW': 'podcasts-education/id1304?letter=W',
             'educationX': 'podcasts-education/id1304?letter=X',
             'educationY': 'podcasts-education/id1304?letter=Y',
             'educationZ': 'podcasts-education/id1304?letter=Z',
             'fictionA': 'podcasts-fiction/id1483?letter=A',
             'fictionB': 'podcasts-fiction/id1483?letter=B',
             'fictionC': 'podcasts-fiction/id1483?letter=C',
             'fictionD': 'podcasts-fiction/id1483?letter=D',
             'fictionE': 'podcasts-fiction/id1483?letter=E',
             'fictionF': 'podcasts-fiction/id1483?letter=F',
             'fictionG': 'podcasts-fiction/id1483?letter=G',
             'fictionH': 'podcasts-fiction/id1483?letter=H',
             'fictionI': 'podcasts-fiction/id1483?letter=I',
             'fictionJ': 'podcasts-fiction/id1483?letter=J',
             'fictionK': 'podcasts-fiction/id1483?letter=K',
             'fictionL': 'podcasts-fiction/id1483?letter=L',
             'fictionM': 'podcasts-fiction/id1483?letter=M',
             'fictionN': 'podcasts-fiction/id1483?letter=N',
             'fictionO': 'podcasts-fiction/id1483?letter=O',
             'fictionP': 'podcasts-fiction/id1483?letter=P',
             'fictionQ': 'podcasts-fiction/id1483?letter=Q',
             'fictionR': 'podcasts-fiction/id1483?letter=R',
             'fictionS': 'podcasts-fiction/id1483?letter=S',
             'fictionT': 'podcasts-fiction/id1483?letter=T',
             'fictionU': 'podcasts-fiction/id1483?letter=U',
             'fictionV': 'podcasts-fiction/id1483?letter=V',
             'fictionW': 'podcasts-fiction/id1483?letter=W',
             'fictionX': 'podcasts-fiction/id1483?letter=X',
             'fictionY': 'podcasts-fiction/id1483?letter=Y',
             'fictionZ': 'podcasts-fiction/id1483?letter=Z',
             'governmentA': 'podcasts-government/id1511?letter=A',
             'governmentB': 'podcasts-government/id1511?letter=B',
             'governmentC': 'podcasts-government/id1511?letter=C',
             'governmentD': 'podcasts-government/id1511?letter=D',
             'governmentE': 'podcasts-government/id1511?letter=E',
             'governmentF': 'podcasts-government/id1511?letter=F',
             'governmentG': 'podcasts-government/id1511?letter=G',
             'governmentH': 'podcasts-government/id1511?letter=H',
             'governmentI': 'podcasts-government/id1511?letter=I',
             'governmentJ': 'podcasts-government/id1511?letter=J',
             'governmentK': 'podcasts-government/id1511?letter=K',
             'governmentL': 'podcasts-government/id1511?letter=L',
             'governmentM': 'podcasts-government/id1511?letter=M',
             'governmentN': 'podcasts-government/id1511?letter=N',
             'governmentO': 'podcasts-government/id1511?letter=O',
             'governmentP': 'podcasts-government/id1511?letter=P',
             'governmentQ': 'podcasts-government/id1511?letter=Q',
             'governmentR': 'podcasts-government/id1511?letter=R',
             'governmentS': 'podcasts-government/id1511?letter=S',
             'governmentT': 'podcasts-government/id1511?letter=T',
             'governmentU': 'podcasts-government/id1511?letter=U',
             'governmentV': 'podcasts-government/id1511?letter=V',
             'governmentW': 'podcasts-government/id1511?letter=W',
             'governmentX': 'podcasts-government/id1511?letter=X',
             'governmentY': 'podcasts-government/id1511?letter=Y',
             'governmentZ': 'podcasts-government/id1511?letter=Z',
             'health_and_fitnessA': 'podcasts-health-fitness/id1512?letter=A',
             'health_and_fitnessB': 'podcasts-health-fitness/id1512?letter=B',
             'health_and_fitnessC': 'podcasts-health-fitness/id1512?letter=C',
             'health_and_fitnessD': 'podcasts-health-fitness/id1512?letter=D',
             'health_and_fitnessE': 'podcasts-health-fitness/id1512?letter=E',
             'health_and_fitnessF': 'podcasts-health-fitness/id1512?letter=F',
             'health_and_fitnessG': 'podcasts-health-fitness/id1512?letter=G',
             'health_and_fitnessH': 'podcasts-health-fitness/id1512?letter=H',
             'health_and_fitnessI': 'podcasts-health-fitness/id1512?letter=I',
             'health_and_fitnessJ': 'podcasts-health-fitness/id1512?letter=J',
             'health_and_fitnessK': 'podcasts-health-fitness/id1512?letter=K',
             'health_and_fitnessL': 'podcasts-health-fitness/id1512?letter=L',
             'health_and_fitnessM': 'podcasts-health-fitness/id1512?letter=M',
             'health_and_fitnessN': 'podcasts-health-fitness/id1512?letter=N',
             'health_and_fitnessO': 'podcasts-health-fitness/id1512?letter=O',
             'health_and_fitnessP': 'podcasts-health-fitness/id1512?letter=P',
             'health_and_fitnessQ': 'podcasts-health-fitness/id1512?letter=Q',
             'health_and_fitnessR': 'podcasts-health-fitness/id1512?letter=R',
             'health_and_fitnessS': 'podcasts-health-fitness/id1512?letter=S',
             'health_and_fitnessT': 'podcasts-health-fitness/id1512?letter=T',
             'health_and_fitnessU': 'podcasts-health-fitness/id1512?letter=U',
             'health_and_fitnessV': 'podcasts-health-fitness/id1512?letter=V',
             'health_and_fitnessW': 'podcasts-health-fitness/id1512?letter=W',
             'health_and_fitnessX': 'podcasts-health-fitness/id1512?letter=X',
             'health_and_fitnessY': 'podcasts-health-fitness/id1512?letter=Y',
             'health_and_fitnessZ': 'podcasts-health-fitness/id1512?letter=Z',
             'historyA': 'podcasts-history/id1487?letter=A',
             'historyB': 'podcasts-history/id1487?letter=B',
             'historyC': 'podcasts-history/id1487?letter=C',
             'historyD': 'podcasts-history/id1487?letter=D',
             'historyE': 'podcasts-history/id1487?letter=E',
             'historyF': 'podcasts-history/id1487?letter=F',
             'historyG': 'podcasts-history/id1487?letter=G',
             'historyH': 'podcasts-history/id1487?letter=H',
             'historyI': 'podcasts-history/id1487?letter=I',
             'historyJ': 'podcasts-history/id1487?letter=J',
             'historyK': 'podcasts-history/id1487?letter=K',
             'historyL': 'podcasts-history/id1487?letter=L',
             'historyM': 'podcasts-history/id1487?letter=M',
             'historyN': 'podcasts-history/id1487?letter=N',
             'historyO': 'podcasts-history/id1487?letter=O',
             'historyP': 'podcasts-history/id1487?letter=P',
             'historyQ': 'podcasts-history/id1487?letter=Q',
             'historyR': 'podcasts-history/id1487?letter=R',
             'historyS': 'podcasts-history/id1487?letter=S',
             'historyT': 'podcasts-history/id1487?letter=T',
             'historyU': 'podcasts-history/id1487?letter=U',
             'historyV': 'podcasts-history/id1487?letter=V',
             'historyW': 'podcasts-history/id1487?letter=W',
             'historyX': 'podcasts-history/id1487?letter=X',
             'historyY': 'podcasts-history/id1487?letter=Y',
             'historyZ': 'podcasts-history/id1487?letter=Z',
             'kids_and_familyA': 'podcasts-kids-family/id1305?letter=A',
             'kids_and_familyB': 'podcasts-kids-family/id1305?letter=B',
             'kids_and_familyC': 'podcasts-kids-family/id1305?letter=C',
             'kids_and_familyD': 'podcasts-kids-family/id1305?letter=D',
             'kids_and_familyE': 'podcasts-kids-family/id1305?letter=E',
             'kids_and_familyF': 'podcasts-kids-family/id1305?letter=F',
             'kids_and_familyG': 'podcasts-kids-family/id1305?letter=G',
             'kids_and_familyH': 'podcasts-kids-family/id1305?letter=H',
             'kids_and_familyI': 'podcasts-kids-family/id1305?letter=I',
             'kids_and_familyJ': 'podcasts-kids-family/id1305?letter=J',
             'kids_and_familyK': 'podcasts-kids-family/id1305?letter=K',
             'kids_and_familyL': 'podcasts-kids-family/id1305?letter=L',
             'kids_and_familyM': 'podcasts-kids-family/id1305?letter=M',
             'kids_and_familyN': 'podcasts-kids-family/id1305?letter=N',
             'kids_and_familyO': 'podcasts-kids-family/id1305?letter=O',
             'kids_and_familyP': 'podcasts-kids-family/id1305?letter=P',
             'kids_and_familyQ': 'podcasts-kids-family/id1305?letter=Q',
             'kids_and_familyR': 'podcasts-kids-family/id1305?letter=R',
             'kids_and_familyS': 'podcasts-kids-family/id1305?letter=S',
             'kids_and_familyT': 'podcasts-kids-family/id1305?letter=T',
             'kids_and_familyU': 'podcasts-kids-family/id1305?letter=U',
             'kids_and_familyV': 'podcasts-kids-family/id1305?letter=V',
             'kids_and_familyW': 'podcasts-kids-family/id1305?letter=W',
             'kids_and_familyX': 'podcasts-kids-family/id1305?letter=X',
             'kids_and_familyY': 'podcasts-kids-family/id1305?letter=Y',
             'kids_and_familyZ': 'podcasts-kids-family/id1305?letter=Z',
             'leisureA': 'podcasts-leisure/id1502?letter=A',
             'leisureB': 'podcasts-leisure/id1502?letter=B',
             'leisureC': 'podcasts-leisure/id1502?letter=C',
             'leisureD': 'podcasts-leisure/id1502?letter=D',
             'leisureE': 'podcasts-leisure/id1502?letter=E',
             'leisureF': 'podcasts-leisure/id1502?letter=F',
             'leisureG': 'podcasts-leisure/id1502?letter=G',
             'leisureH': 'podcasts-leisure/id1502?letter=H',
             'leisureI': 'podcasts-leisure/id1502?letter=I',
             'leisureJ': 'podcasts-leisure/id1502?letter=J',
             'leisureK': 'podcasts-leisure/id1502?letter=K',
             'leisureL': 'podcasts-leisure/id1502?letter=L',
             'leisureM': 'podcasts-leisure/id1502?letter=M',
             'leisureN': 'podcasts-leisure/id1502?letter=N',
             'leisureO': 'podcasts-leisure/id1502?letter=O',
             'leisureP': 'podcasts-leisure/id1502?letter=P',
             'leisureQ': 'podcasts-leisure/id1502?letter=Q',
             'leisureR': 'podcasts-leisure/id1502?letter=R',
             'leisureS': 'podcasts-leisure/id1502?letter=S',
             'leisureT': 'podcasts-leisure/id1502?letter=T',
             'leisureU': 'podcasts-leisure/id1502?letter=U',
             'leisureV': 'podcasts-leisure/id1502?letter=V',
             'leisureW': 'podcasts-leisure/id1502?letter=W',
             'leisureX': 'podcasts-leisure/id1502?letter=X',
             'leisureY': 'podcasts-leisure/id1502?letter=Y',
             'leisureZ': 'podcasts-leisure/id1502?letter=Z',
             'musicA': 'podcasts-music/id1310?letter=A',
             'musicB': 'podcasts-music/id1310?letter=B',
             'musicC': 'podcasts-music/id1310?letter=C',
             'musicD': 'podcasts-music/id1310?letter=D',
             'musicE': 'podcasts-music/id1310?letter=E',
             'musicF': 'podcasts-music/id1310?letter=F',
             'musicG': 'podcasts-music/id1310?letter=G',
             'musicH': 'podcasts-music/id1310?letter=H',
             'musicI': 'podcasts-music/id1310?letter=I',
             'musicJ': 'podcasts-music/id1310?letter=J',
             'musicK': 'podcasts-music/id1310?letter=K',
             'musicL': 'podcasts-music/id1310?letter=L',
             'musicM': 'podcasts-music/id1310?letter=M',
             'musicN': 'podcasts-music/id1310?letter=N',
             'musicO': 'podcasts-music/id1310?letter=O',
             'musicP': 'podcasts-music/id1310?letter=P',
             'musicQ': 'podcasts-music/id1310?letter=Q',
             'musicR': 'podcasts-music/id1310?letter=R',
             'musicS': 'podcasts-music/id1310?letter=S',
             'musicT': 'podcasts-music/id1310?letter=T',
             'musicU': 'podcasts-music/id1310?letter=U',
             'musicV': 'podcasts-music/id1310?letter=V',
             'musicW': 'podcasts-music/id1310?letter=W',
             'musicX': 'podcasts-music/id1310?letter=X',
             'musicY': 'podcasts-music/id1310?letter=Y',
             'musicZ': 'podcasts-music/id1310?letter=Z',
             'newsA': 'podcasts-news/id1489?letter=A',
             'newsB': 'podcasts-news/id1489?letter=B',
             'newsC': 'podcasts-news/id1489?letter=C',
             'newsD': 'podcasts-news/id1489?letter=D',
             'newsE': 'podcasts-news/id1489?letter=E',
             'newsF': 'podcasts-news/id1489?letter=F',
             'newsG': 'podcasts-news/id1489?letter=G',
             'newsH': 'podcasts-news/id1489?letter=H',
             'newsI': 'podcasts-news/id1489?letter=I',
             'newsJ': 'podcasts-news/id1489?letter=J',
             'newsK': 'podcasts-news/id1489?letter=K',
             'newsL': 'podcasts-news/id1489?letter=L',
             'newsM': 'podcasts-news/id1489?letter=M',
             'newsN': 'podcasts-news/id1489?letter=N',
             'newsO': 'podcasts-news/id1489?letter=O',
             'newsP': 'podcasts-news/id1489?letter=P',
             'newsQ': 'podcasts-news/id1489?letter=Q',
             'newsR': 'podcasts-news/id1489?letter=R',
             'newsS': 'podcasts-news/id1489?letter=S',
             'newsT': 'podcasts-news/id1489?letter=T',
             'newsU': 'podcasts-news/id1489?letter=U',
             'newsV': 'podcasts-news/id1489?letter=V',
             'newsW': 'podcasts-news/id1489?letter=W',
             'newsX': 'podcasts-news/id1489?letter=X',
             'newsY': 'podcasts-news/id1489?letter=Y',
             'newsZ': 'podcasts-news/id1489?letter=Z',
             'religion_and_spiritualityA': 'podcasts-religion-spirituality/id1314?letter=A',
             'religion_and_spiritualityB': 'podcasts-religion-spirituality/id1314?letter=B',
             'religion_and_spiritualityC': 'podcasts-religion-spirituality/id1314?letter=C',
             'religion_and_spiritualityD': 'podcasts-religion-spirituality/id1314?letter=D',
             'religion_and_spiritualityE': 'podcasts-religion-spirituality/id1314?letter=E',
             'religion_and_spiritualityF': 'podcasts-religion-spirituality/id1314?letter=F',
             'religion_and_spiritualityG': 'podcasts-religion-spirituality/id1314?letter=G',
             'religion_and_spiritualityH': 'podcasts-religion-spirituality/id1314?letter=H',
             'religion_and_spiritualityI': 'podcasts-religion-spirituality/id1314?letter=I',
             'religion_and_spiritualityJ': 'podcasts-religion-spirituality/id1314?letter=J',
             'religion_and_spiritualityK': 'podcasts-religion-spirituality/id1314?letter=K',
             'religion_and_spiritualityL': 'podcasts-religion-spirituality/id1314?letter=L',
             'religion_and_spiritualityM': 'podcasts-religion-spirituality/id1314?letter=M',
             'religion_and_spiritualityN': 'podcasts-religion-spirituality/id1314?letter=N',
             'religion_and_spiritualityO': 'podcasts-religion-spirituality/id1314?letter=O',
             'religion_and_spiritualityP': 'podcasts-religion-spirituality/id1314?letter=P',
             'religion_and_spiritualityQ': 'podcasts-religion-spirituality/id1314?letter=Q',
             'religion_and_spiritualityR': 'podcasts-religion-spirituality/id1314?letter=R',
             'religion_and_spiritualityS': 'podcasts-religion-spirituality/id1314?letter=S',
             'religion_and_spiritualityT': 'podcasts-religion-spirituality/id1314?letter=T',
             'religion_and_spiritualityU': 'podcasts-religion-spirituality/id1314?letter=U',
             'religion_and_spiritualityV': 'podcasts-religion-spirituality/id1314?letter=V',
             'religion_and_spiritualityW': 'podcasts-religion-spirituality/id1314?letter=W',
             'religion_and_spiritualityX': 'podcasts-religion-spirituality/id1314?letter=X',
             'religion_and_spiritualityY': 'podcasts-religion-spirituality/id1314?letter=Y',
             'religion_and_spiritualityZ': 'podcasts-religion-spirituality/id1314?letter=Z',
             'scienceA': 'podcasts-science/id1533?letter=A',
             'scienceB': 'podcasts-science/id1533?letter=B',
             'scienceC': 'podcasts-science/id1533?letter=C',
             'scienceD': 'podcasts-science/id1533?letter=D',
             'scienceE': 'podcasts-science/id1533?letter=E',
             'scienceF': 'podcasts-science/id1533?letter=F',
             'scienceG': 'podcasts-science/id1533?letter=G',
             'scienceH': 'podcasts-science/id1533?letter=H',
             'scienceI': 'podcasts-science/id1533?letter=I',
             'scienceJ': 'podcasts-science/id1533?letter=J',
             'scienceK': 'podcasts-science/id1533?letter=K',
             'scienceL': 'podcasts-science/id1533?letter=L',
             'scienceM': 'podcasts-science/id1533?letter=M',
             'scienceN': 'podcasts-science/id1533?letter=N',
             'scienceO': 'podcasts-science/id1533?letter=O',
             'scienceP': 'podcasts-science/id1533?letter=P',
             'scienceQ': 'podcasts-science/id1533?letter=Q',
             'scienceR': 'podcasts-science/id1533?letter=R',
             'scienceS': 'podcasts-science/id1533?letter=S',
             'scienceT': 'podcasts-science/id1533?letter=T',
             'scienceU': 'podcasts-science/id1533?letter=U',
             'scienceV': 'podcasts-science/id1533?letter=V',
             'scienceW': 'podcasts-science/id1533?letter=W',
             'scienceX': 'podcasts-science/id1533?letter=X',
             'scienceY': 'podcasts-science/id1533?letter=Y',
             'scienceZ': 'podcasts-science/id1533?letter=Z',
             'society_and_cultureA': 'podcasts-society-culture/id1324?letter=A',
             'society_and_cultureB': 'podcasts-society-culture/id1324?letter=B',
             'society_and_cultureC': 'podcasts-society-culture/id1324?letter=C',
             'society_and_cultureD': 'podcasts-society-culture/id1324?letter=D',
             'society_and_cultureE': 'podcasts-society-culture/id1324?letter=E',
             'society_and_cultureF': 'podcasts-society-culture/id1324?letter=F',
             'society_and_cultureG': 'podcasts-society-culture/id1324?letter=G',
             'society_and_cultureH': 'podcasts-society-culture/id1324?letter=H',
             'society_and_cultureI': 'podcasts-society-culture/id1324?letter=I',
             'society_and_cultureJ': 'podcasts-society-culture/id1324?letter=J',
             'society_and_cultureK': 'podcasts-society-culture/id1324?letter=K',
             'society_and_cultureL': 'podcasts-society-culture/id1324?letter=L',
             'society_and_cultureM': 'podcasts-society-culture/id1324?letter=M',
             'society_and_cultureN': 'podcasts-society-culture/id1324?letter=N',
             'society_and_cultureO': 'podcasts-society-culture/id1324?letter=O',
             'society_and_cultureP': 'podcasts-society-culture/id1324?letter=P',
             'society_and_cultureQ': 'podcasts-society-culture/id1324?letter=Q',
             'society_and_cultureR': 'podcasts-society-culture/id1324?letter=R',
             'society_and_cultureS': 'podcasts-society-culture/id1324?letter=S',
             'society_and_cultureT': 'podcasts-society-culture/id1324?letter=T',
             'society_and_cultureU': 'podcasts-society-culture/id1324?letter=U',
             'society_and_cultureV': 'podcasts-society-culture/id1324?letter=V',
             'society_and_cultureW': 'podcasts-society-culture/id1324?letter=W',
             'society_and_cultureX': 'podcasts-society-culture/id1324?letter=X',
             'society_and_cultureY': 'podcasts-society-culture/id1324?letter=Y',
             'society_and_cultureZ': 'podcasts-society-culture/id1324?letter=Z',
             'sportsA': 'podcasts-sports/id1545?letter=A',
             'sportsB': 'podcasts-sports/id1545?letter=B',
             'sportsC': 'podcasts-sports/id1545?letter=C',
             'sportsD': 'podcasts-sports/id1545?letter=D',
             'sportsE': 'podcasts-sports/id1545?letter=E',
             'sportsF': 'podcasts-sports/id1545?letter=F',
             'sportsG': 'podcasts-sports/id1545?letter=G',
             'sportsH': 'podcasts-sports/id1545?letter=H',
             'sportsI': 'podcasts-sports/id1545?letter=I',
             'sportsJ': 'podcasts-sports/id1545?letter=J',
             'sportsK': 'podcasts-sports/id1545?letter=K',
             'sportsL': 'podcasts-sports/id1545?letter=L',
             'sportsM': 'podcasts-sports/id1545?letter=M',
             'sportsN': 'podcasts-sports/id1545?letter=N',
             'sportsO': 'podcasts-sports/id1545?letter=O',
             'sportsP': 'podcasts-sports/id1545?letter=P',
             'sportsQ': 'podcasts-sports/id1545?letter=Q',
             'sportsR': 'podcasts-sports/id1545?letter=R',
             'sportsS': 'podcasts-sports/id1545?letter=S',
             'sportsT': 'podcasts-sports/id1545?letter=T',
             'sportsU': 'podcasts-sports/id1545?letter=U',
             'sportsV': 'podcasts-sports/id1545?letter=V',
             'sportsW': 'podcasts-sports/id1545?letter=W',
             'sportsX': 'podcasts-sports/id1545?letter=X',
             'sportsY': 'podcasts-sports/id1545?letter=Y',
             'sportsZ': 'podcasts-sports/id1545?letter=Z',
             'technologyA': 'podcasts-tv-film/id1309?letter=A',
             'technologyB': 'podcasts-tv-film/id1309?letter=B',
             'technologyC': 'podcasts-tv-film/id1309?letter=C',
             'technologyD': 'podcasts-tv-film/id1309?letter=D',
             'technologyE': 'podcasts-tv-film/id1309?letter=E',
             'technologyF': 'podcasts-tv-film/id1309?letter=F',
             'technologyG': 'podcasts-tv-film/id1309?letter=G',
             'technologyH': 'podcasts-tv-film/id1309?letter=H',
             'technologyI': 'podcasts-tv-film/id1309?letter=I',
             'technologyJ': 'podcasts-tv-film/id1309?letter=J',
             'technologyK': 'podcasts-tv-film/id1309?letter=K',
             'technologyL': 'podcasts-tv-film/id1309?letter=L',
             'technologyM': 'podcasts-tv-film/id1309?letter=M',
             'technologyN': 'podcasts-tv-film/id1309?letter=N',
             'technologyO': 'podcasts-tv-film/id1309?letter=O',
             'technologyP': 'podcasts-tv-film/id1309?letter=P',
             'technologyQ': 'podcasts-tv-film/id1309?letter=Q',
             'technologyR': 'podcasts-tv-film/id1309?letter=R',
             'technologyS': 'podcasts-tv-film/id1309?letter=S',
             'technologyT': 'podcasts-tv-film/id1309?letter=T',
             'technologyU': 'podcasts-tv-film/id1309?letter=U',
             'technologyV': 'podcasts-tv-film/id1309?letter=V',
             'technologyW': 'podcasts-tv-film/id1309?letter=W',
             'technologyX': 'podcasts-tv-film/id1309?letter=X',
             'technologyY': 'podcasts-tv-film/id1309?letter=Y',
             'technologyZ': 'podcasts-tv-film/id1309?letter=Z',
             'true_crimeA': 'podcasts-true-crime/id1488?letter=A',
             'true_crimeB': 'podcasts-true-crime/id1488?letter=B',
             'true_crimeC': 'podcasts-true-crime/id1488?letter=C',
             'true_crimeD': 'podcasts-true-crime/id1488?letter=D',
             'true_crimeE': 'podcasts-true-crime/id1488?letter=E',
             'true_crimeF': 'podcasts-true-crime/id1488?letter=F',
             'true_crimeG': 'podcasts-true-crime/id1488?letter=G',
             'true_crimeH': 'podcasts-true-crime/id1488?letter=H',
             'true_crimeI': 'podcasts-true-crime/id1488?letter=I',
             'true_crimeJ': 'podcasts-true-crime/id1488?letter=J',
             'true_crimeK': 'podcasts-true-crime/id1488?letter=K',
             'true_crimeL': 'podcasts-true-crime/id1488?letter=L',
             'true_crimeM': 'podcasts-true-crime/id1488?letter=M',
             'true_crimeN': 'podcasts-true-crime/id1488?letter=N',
             'true_crimeO': 'podcasts-true-crime/id1488?letter=O',
             'true_crimeP': 'podcasts-true-crime/id1488?letter=P',
             'true_crimeQ': 'podcasts-true-crime/id1488?letter=Q',
             'true_crimeR': 'podcasts-true-crime/id1488?letter=R',
             'true_crimeS': 'podcasts-true-crime/id1488?letter=S',
             'true_crimeT': 'podcasts-true-crime/id1488?letter=T',
             'true_crimeU': 'podcasts-true-crime/id1488?letter=U',
             'true_crimeV': 'podcasts-true-crime/id1488?letter=V',
             'true_crimeW': 'podcasts-true-crime/id1488?letter=W',
             'true_crimeX': 'podcasts-true-crime/id1488?letter=X',
             'true_crimeY': 'podcasts-true-crime/id1488?letter=Y',
             'true_crimeZ': 'podcasts-true-crime/id1488?letter=Z',
             'tv_and_filmA': 'podcasts-technology/id1318?letter=A',
             'tv_and_filmB': 'podcasts-technology/id1318?letter=B',
             'tv_and_filmC': 'podcasts-technology/id1318?letter=C',
             'tv_and_filmD': 'podcasts-technology/id1318?letter=D',
             'tv_and_filmE': 'podcasts-technology/id1318?letter=E',
             'tv_and_filmF': 'podcasts-technology/id1318?letter=F',
             'tv_and_filmG': 'podcasts-technology/id1318?letter=G',
             'tv_and_filmH': 'podcasts-technology/id1318?letter=H',
             'tv_and_filmI': 'podcasts-technology/id1318?letter=I',
             'tv_and_filmJ': 'podcasts-technology/id1318?letter=J',
             'tv_and_filmK': 'podcasts-technology/id1318?letter=K',
             'tv_and_filmL': 'podcasts-technology/id1318?letter=L',
             'tv_and_filmM': 'podcasts-technology/id1318?letter=M',
             'tv_and_filmN': 'podcasts-technology/id1318?letter=N',
             'tv_and_filmO': 'podcasts-technology/id1318?letter=O',
             'tv_and_filmP': 'podcasts-technology/id1318?letter=P',
             'tv_and_filmQ': 'podcasts-technology/id1318?letter=Q',
             'tv_and_filmR': 'podcasts-technology/id1318?letter=R',
             'tv_and_filmS': 'podcasts-technology/id1318?letter=S',
             'tv_and_filmT': 'podcasts-technology/id1318?letter=T',
             'tv_and_filmU': 'podcasts-technology/id1318?letter=U',
             'tv_and_filmV': 'podcasts-technology/id1318?letter=V',
             'tv_and_filmW': 'podcasts-technology/id1318?letter=W',
             'tv_and_filmX': 'podcasts-technology/id1318?letter=X',
             'tv_and_filmY': 'podcasts-technology/id1318?letter=Y',
             'tv_and_filmZ': 'podcasts-technology/id1318?letter=Z'
        }

        # Create the 'categories' directory if it doesn't exist.
        if not self.path.exists():
            self.path.mkdir(parents=True)

        for category, slug in CATEGORIES.items():
            current_url = "%s%s" % (ITUNES_BASE_URL, slug)
            logging.info("Scraping Category: %s." % slug)

            try:
                result = self.session.get(current_url, timeout=TIMEOUT)
            except requests.exceptions.Timeout:
                logging.error("Timeout for %s" % current_url)
                break

            if result.status_code != 200:
                logging.error("No 200 returned for URL %s" % current_url)
                break

            html_contents = result.content
            soup = BeautifulSoup(html_contents, "lxml")
            urls = []
            for pagination_tag in soup.select('div.column ul li a'):
                page_url = pagination_tag.get("href")
                urls.append(page_url)

            self._writeCategory(category, urls)

    def _writeCategory(self, category, urls):
        """Write the passed in List of urls to a CSV file named category."""
        filePath = self.path.joinpath("%s.csv" % category).expanduser()
        with open(filePath, 'w') as f:
            writer = csv.writer(f, delimiter=',', quoting=csv.QUOTE_ALL)

            for url in urls:
                logging.debug("Writing URL %s" % url)
                writer.writerow([url])

        f.close()
